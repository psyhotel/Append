package com.voicenotes.services

import java.io.File

class OpenAIService {
    private val apiKey = System.getenv("OPENAI_API_KEY") ?: ""
    
    suspend fun transcribeAudio(audioFile: File): String {
        if (apiKey.isEmpty()) {
            return "[–¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –¥–µ–º–æ-—Ä–µ–∂–∏–º–µ. –î–æ–±–∞–≤—å—Ç–µ OPENAI_API_KEY –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–π —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏]\n\n–ü—Ä–∏–º–µ—Ä —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏: –≠—Ç–æ –æ—Ç–ª–∏—á–Ω–∞—è –±–∏–∑–Ω–µ—Å-–∏–¥–µ—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–º–æ–∂–µ—Ç –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –º—ã—Å–ª–∏ –∏ –ø—Ä–µ–≤—Ä–∞—â–∞—Ç—å –∏—Ö –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–ª–∞–Ω—ã."
        }
        
        return "–¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è OPENAI_API_KEY"
    }
    
    suspend fun generateBusinessReport(transcription: String): String {
        return generateMockReport(transcription)
    }
    
    private fun generateMockReport(transcription: String): String {
        return """
            üìä –ë–ò–ó–ù–ï–°-–û–¢–ß–ï–¢
            
            üí° –°—É—Ç—å –∏–¥–µ–∏:
            ${transcription.take(200)}...
            
            üéØ –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è:
            –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ä—ã–Ω–∫–∞.
            
            üí∞ –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å:
            ‚Ä¢ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∫–ª–∏–µ–Ω—Ç–∞
            ‚Ä¢ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
            ‚Ä¢ –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –ø–æ–¥–ø–∏—Å–∫—É
            
            ‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–∏—Å–∫–∏:
            ‚Ä¢ –ö–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è –Ω–∞ —Ä—ã–Ω–∫–µ
            ‚Ä¢ –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≥–∏–ø–æ—Ç–µ–∑
            ‚Ä¢ –ü–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –≤ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è—Ö
            
            üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
            1. –ü—Ä–æ–≤–µ—Å—Ç–∏ customer development
            2. –°–æ–∑–¥–∞—Ç—å MVP
            3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏
            
            ‚ÑπÔ∏è –î–ª—è –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ AI-–∞–Ω–∞–ª–∏–∑–∞ –¥–æ–±–∞–≤—å—Ç–µ OPENAI_API_KEY –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.
        """.trimIndent()
    }
}
